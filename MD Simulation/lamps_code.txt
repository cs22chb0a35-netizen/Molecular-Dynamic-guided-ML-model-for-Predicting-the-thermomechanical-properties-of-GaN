# -------------------------------------------------------------------------
# LAMMPS Input Script for Tensile Deformation of Gallium Nitride (GaN)
# -------------------------------------------------------------------------

# --- 1. Initialization ---
units           metal
dimension       3
boundary        p p p
atom_style      atomic

# --- 2. Atom Definition (Wurtzite Structure) ---
# Lattice constants for GaN: a = 3.189 A, c = 5.185 A
variable a equal 3.189
variable c equal 5.185

# Define Wurtzite unit cell using custom lattice
lattice custom $a a1 1.0 0.0 0.0 a2 -0.5 0.866025 0.0 a3 0.0 0.0 1.6259 &
        basis 0.0 0.0 0.0      & # Ga
        basis 0.3333 0.6667 0.0  & # Ga
        basis 0.0 0.0 0.375    & # N
        basis 0.3333 0.6667 0.375 # N

region          mybox block 0 10 0 10 0 10
create_box      2 mybox
create_atoms    1 box basis 1 1 basis 2 1 basis 3 2 basis 4 2

# Define masses (1=Ga, 2=N)
mass            1 69.723
mass            2 14.007

# --- 3. Force Fields (Interatomic Potential) ---
# Using Tersoff potential (Standard for GaN mechanical properties)
pair_style      tersoff
pair_coeff      * * GaN.tersoff Ga N

# --- 4. Minimization (Relax Structure) ---
minimize        1.0e-4 1.0e-6 1000 10000
reset_timestep  0

# --- 5. Equilibration (NPT Ensemble) ---
# Set temperature (e.g., 300K - can be overridden via command line)
variable        sim_temp equal 300

velocity        all create ${sim_temp} 12345 dist gaussian
fix             1 all npt temp ${sim_temp} ${sim_temp} 0.1 iso 0.0 0.0 1.0

thermo          100
thermo_style    custom step temp press vol lx ly lz
run             5000
unfix           1

# --- 6. Tensile Deformation ---
# Store initial length L0 for strain calculation
variable        L0 equal lx

# Deform the box in x-direction (Uniaxial Strain)
# Strain rate = 0.001 / ps (approx)
fix             2 all deform 1 x erate 0.001 remap x

# Maintain temp control (NVT during deformation)
fix             3 all nvt temp ${sim_temp} ${sim_temp} 0.1

# --- 7. Define Computes & Variables for Output ---
# Strain = (Current Length - Initial Length) / Initial Length
variable        strain equal (lx-v_L0)/v_L0

# Stress in GPa (Pxx is in bars, divide by 10000)
variable        stress equal -pxx/10000

# --- 8. Output: Fix Print (The Raw Data) ---
# This generates the log file your Python script would "parse"
fix             data_out all print 100 "${sim_temp}, ${strain}, ${stress}" file tensile_output_300K.csv screen no title "Temp,Strain,Stress_GPa"

thermo          100
thermo_style    custom step temp v_strain v_stress
run             20000

print           "Simulation Complete"
